<!DOCTYPE html>
<html lang="ru">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>Planner</title>

        <!-- Fonts & Icons -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <!--<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<!--        <link rel="stylesheet" href="assets/fontawesome/css/all.min.css">-->
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="assets/fontawesome/css/all.min.css">
        <link rel="stylesheet" href="style.css">

        <!-- PWA meta -->
        <link rel="manifest" href="manifest.webmanifest">
        <meta name="theme-color" content="#1f4ea1">

        <!-- iOS/iPadOS -->
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="apple-mobile-web-app-title" content="Planner">
    </head>

    <body>
        <div class="wrapper">

            <!-- ═══ 1. Aircraft (unchanged) ═══════════════════ -->
            <section class="card current">
                <h2><i class="fa-solid fa-plane"></i>Данные о рейсе</h2>
                <div class="fields">
                    <div class="field"><label>Номер ВС</label><input id="acnum" placeholder="73XXX" type="number" min="73093" max="73129"></div>
                    <div class="field"><label>Вылет</label><input id="icaoFrom" placeholder="ICAO / IATA" type="text" maxlength="4" pattern="[A-Za-z]{3,4}"></div>
                    <div class="field"><label>Назначение</label><input id="icaoTo" placeholder="ICAO / IATA" type="text" maxlength="4" pattern="[A-Za-z]{3,4}"></div>
                    <div class="field"><label>Запасной</label><input id="icaoAlt" placeholder="ICAO / IATA" type="text" maxlength="4" pattern="[A-Za-z]{3,4}"></div>
                    <div class="field for-refresh-button">
                        <button class="calc" id="refreshPage" onclick='location.reload()'><i class="fa-solid fa-recycle"></i></button>
                    </div>
                </div>
            </section>

            <!-- ═══ 2. Old SFP (unchanged) ════════════════════ -->
            <section class="card old">
                <h2><i class="fa-solid fa-clock-rotate-left"></i>Старый SFP</h2>
                <div class="fields">
                    <div class="field"><label>TRIP FUEL</label><input id="tripFuelOld" type="number" min="0" max="21000"></div>
                    <div class="field"><label>TRIP TIME</label><input id="ttOld" type="text" placeholder="HH:MM"></div>
                    <div class="field"><label>PAYLOAD</label><input id="payload2" type="number" min="0" max="25000"></div>
                    <div class="field"><label>FOB</label><input id="totalFuelOld" type="number" min="0" max="21000"></div>
                    <div class="field"><label>AD</label><input id="ad" type="number" min="0" max="4000"></div>
                    <div class="field"><label>Номер ВС</label><input id="acnumOld" placeholder="73XXX" type="number" min="73093" max="73129"></div>
                    <div class="field"><label>AVG W/C</label><input id="avgwcOld" type="number" min="-150" max="150"></div>
                    <div class="field"><label>ELDW</label><input id="eldwOld" type="number" min="0" max="66360"></div>
                </div>
            </section>

            <!-- ═══ 3. Current Route (UPDATED) ═══════════════ -->
            <section class="card">
                <h2><i class="fa-solid fa-route"></i>Актуальные данные</h2>

                <div class="route-row">
                    <!-- textarea + buttons -->
                    <div class="route-left">
                        <div class="field" style="flex: 1;">
                            <label id="routeLabel">ROUTE</label>
                            <select id="routeDropdown">
                                <option value="no-item">Нет маршрутов</option>
                            </select>
                            <textarea id="route" placeholder="PILUG B155 IKT A815 TUTEK..."></textarea>
                        </div>
                        <div class="route-buttons">
                            <button class="icon-btn" id="requestRoutes" title="Список маршрутов"><i class="fa-solid fa-download"></i></button>
                            <button class="icon-btn" id="copyRoute" title="Копировать"><i class="fa-solid fa-copy"></i></button>
                            <button class="icon-btn" id="clrR" title="Очистить"><i class="fa-solid fa-trash"></i></button>
                        </div>
                    </div>

                    <!-- ETD + wind + AVG -->
                    <div class="route-middle">
                        <div class="field">
                            <label>ETD (UTC)</label>
                            <div class='date-field'>
                                <input id="dtUtc" type="datetime-local">
                                <button class="icon-btn" id="setNowDate"><i class="fa-solid fa-calendar-check"></i></button>
                            </div>
                        </div>
                        <button class="calc" id="windBtn"><i class="fa-solid fa-wind"></i>Рассчитать и получить ветер</button>
                        <div class="field current">
                            <label id='avgWindCompLabel'>AVG W/C</label>
                            <input id="avgwcNew" type="number" min="-150" max="150">
                        </div>
                    </div>

                    <div class="route-right">
                        <div class="field"><label>PAYLOAD</label><input id="payload1" type="number" min="0" max="25000"></div>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="field"><label>MTOW (PERF)</label>
                                <div style="display:flex;gap:.6rem;align-items:center;"><input id="mtow" type="number" min="0" max="79015"><input id="mtowOwn" type="checkbox" class="big"></div>
                            </div>
                            <div class="field"><label>MLDW (PERF)</label>
                                <div style="display:flex;gap:.6rem;align-items:center;"><input id="mldw" type="number" min="0" max="66360"><input id="mldwOwn" type="checkbox" class="big"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- кнопка-триггер -->
            <button class="calc" id="calcBtn"><i class="fa-solid fa-arrow-down"></i> Вычислить</button>

            <!-- ═══ 4. Results (unchanged) ═══════════════════ -->
            <section class="card">
                <h2><i class="fa-solid fa-calculator"></i>Вычисленные значения</h2>
                <div class="fields">
                    <div class="field"><label>Номер ВС</label><input id="accNumDub" readonly value="-"></div>
                    <div class="field"><label>EZFW</label><input id="ezfw" readonly value="-"></div>
                    <div class="field"><label>DOW</label><input id="dow" readonly value="-"></div>
                    <div class="field"><label>DOI</label><input id="doi" readonly value="-"></div>
                    <div class="field"><label>PAYLOAD</label><input id="payloadActualDub" readonly value="-"></div>
                </div>
                <div class="sub">Варианты заправки</div>
                <div class="sub-mini">Перерасчет SFP</div>
                <div class="fields">
                    <div class="field"><label>AD</label><input id="adCalc" readonly value="-"></div>
                    <div class="field"><label>TRIP FUEL</label><input id="tripFuelCalc" readonly value="-"></div>
                    <div class="field"><label>TRIP TIME</label><input id="tripTimeCalc" readonly value="00:00"></div>
                    <div class="field"><label>FOB</label><input id="f2Calc" readonly value="-"></div>
                </div>
                <div class="sub-mini">Расчет SimBrief</div>
                <div class="fields">
                    <div class="field"><label>AD</label><input id="adCalcSim" readonly value="-"></div>
                    <div class="field"><label>TRIP FUEL</label><input id="tripFuelCalcSim" readonly value="-"></div>
                    <div class="field"><label>TRIP TIME</label><input id="tripTimeCalcSim" readonly value="00:00"></div>
                    <div class="field"><label>FOB</label><input id="f2CalcSim" readonly value="-"></div>
                </div>
                <div class="sub-mini">Дополнительно</div>
                <div class="fields">
                    <div class="field"><label>FOB (типовая из таблицы)</label><input id="fTypeCalc" readonly value="-"></div>
                    <div class="field"><label>FOB (AD * 6 + 3000)</label><input id="fADCalc" readonly value="-"></div>
                    <div class="field super"><label id="recFobLabel">Рекомендуемый</label><input id="fSuperTotal" readonly value="-"></div>
                </div>
                <div class="sub">Ограничения</div>
                <div class="sub-mini">MAX TOTAL FOB</div>
                <div class="fields">
                    <div class="field"><label>По MTOW</label><input id="FmaxTO" readonly value="-"></div>
                    <div class="field"><label>По MLDW</label><input id="FmaxLDG" readonly value="-"></div>
                    <div class="field"><label>По MAX TANKS</label><input id="FmaxTanks" readonly value="-"></div>
                    <div class="field super-mini"><label>Используемый MAX FOB</label><input id="FmaxUsable" readonly value="-"></div>
                </div>
                <div class="sub-mini">MAX PAYLOAD</div>
                <div class="fields">
                    <div class="field"><label>По MZFW</label><input id="payloadMaxMZFW" readonly value="-"></div>
                    <div class="field"><label>По MTOW</label><input id="payloadMaxMTOW" readonly value="-"></div>
                    <div class="field"><label>По MLDW</label><input id="payloadMaxMLDW" readonly value="-"></div>
                    <div class="field super-mini"><label>Используемый MAX PLD</label><input id="payloadMaxUsable" readonly value="-"></div>
                </div>
            </section>

        </div>

        <script src="assets/data/airports.js"></script>
        <script src="utils.js"></script>
        <script src="script.js"></script>

        <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js', { scope: './' })
                    .catch(console.error);
            });
        }
</script>
    </body>

</html>